---
title:     "Вакидзаси"
excerpt:   "Самая подробная статья про мою аккордовую клавиатуру."
permalink: wakizashi
layout:    ru
published: false
---
# Вакидзаси

![](/data/img/wakizashi.jpg)

Буквально все последние статьи на этом сайте про вакидзаси, мою аккордовую
клавиатуру. Некоторым читателям это не нравится. Ну и ладно.

## Введение

Стандартные клавиатуры — сборник пережитков прошлого. Начиная от сдвигов рядов,
заканчивая неэффективными раскладками и абсурдным расположением многих клавиш
(вот где кнопка `Ctrl` (часто нужная клавиша в неудобном месте) и где кнопка
`Caps Lock` (ненужная кнопка в очень удобном месте)).

Люди, которые не хотят мириться с недостатками стандартной раскладки,
устанавливают себе альтернативные раскладки. Люди, которые не хотят мириться и с
клавиатурами, покупают или собирают себе *эргономичные* клавиатуры.

Клавиатурой, которая толкнула меня на путь клавиатурщика, была Кошкоклава. На
хабре есть [хорошая статья](https://habr.com/ru/post/185500/) от автора
клавиатуры. Там есть про эргоклавы в целом много всякого.

![](https://habrastorage.org/getpro/habr/post_images/e3e/097/f9c/e3e097f9c927dd888bd4b29db38e7b86.jpg)

После прочтения этой статьи (это было давно) я загорелся идеей когда-нибудь
сделать свою самую эргономичную, самую классную клавиатуру. Дело отложилось на
года.

В январе мне придумалась клавиатура всего с 11 кнопками, способная работать как
большая, взрослая клавиатура. Я назвал её вакидзаси, по аналогии со
вспомогательными мечами самураев. Решил проверить на практике, как хороша эта
идея клавиатуры.

![Меч
вакидзаси](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Antique_Japanese_%28samurai%29_wakizashi.JPG/800px-Antique_Japanese_%28samurai%29_wakizashi.JPG)

Сначала в голове была мысль держать её как вспомогательную, но в итоге она стала
позиционироваться как полноценная.

Так в чём же соль, чем сильна вакидзаси?

## Соль

А соль в аккордах. Чтобы написать символ, нужно нажать не одну клавишу (плюс
какие-нибудь модификаторы), а несколько клавиш. Программа смотрит, какие клавиши
были нажаты, и отправляет в компьютер сканкод обычной клавиатуры. Компьютер и не
знает, что к нему подключено что-то хитрое.

Поскольку все клавиши под пальцами, не надо двигать рукой. В этом эргономичная
составляющая вакидзаси.

Поскольку кнопок мало, собрать клавиатуру проще. Отличный старт в мире
самодельных клавиатур. Про сборку клавиатуры я написал [статью с
картинками](https://bouncepaw.github.io/wakizashi-build).

## Аккорды

Под каждый фингер (термин, обозначающий все пальцы руки, кроме большого, а также
кнопки под такие пальцы) отводится по две кнопки. На самом деле, палец без
проблем может нажимать сразу две клавиши. Под тамб (термин, обозначающий большой
палец руки и кнопки под него) же отведено целых три клавиши. Я решил, что две
слишком мало, а четыре многовато.

Есть пять доступных комбинация тамбов, то есть доступных аккордов `2^8 \* (5+1)
= 1536`. Это больше, чем на стандартной клавиатуре! Также есть два слоя
раскладки (латиница и кириллица), что увеличивает количество аккордов вдвое!

Итого: **3072 аккордов** с одной руки.

Мощь безграничная.

Вот такую смысловую нагрузку я дал тамбам:

![](/data/img/wakizashi-thumbs.png)

Эти названия не эквивалентны тому, что есть на обычных клавиатурах. Это просто
мнемоника, которая показывает, что:

1. Аккорды с левым тамбом включают в себя большие буквы, но не всегда так.
2. Аккорды с центральным тамбом включают в себя символы, но не всегда так.
3. Аккорды с правым тамбом включают в себя функциональные клавиши, такие как
   `Page Up`, `Home`, etc.
4. Аккорды с левым и центральным тамбом работают как аккорды с просто левым
   тамбом, но также отправляется нажатие кнопки `Ctrl`.
5. Аккорды с центральным и правым тамбом отправляют не одни символы, а целые
   слова или их кусочки.

## Прошивка

Многие любители клавиатурных дел берут за основу прошивки чудный фреймворк
[QMK](https://qmk.fm), но я посчитал его излишним, и написал всё почти с нуля,
взяв за основу библиотеки Ардуино. Ну, написал, работает хорошо. Та часть
прошивки, которая про раскладку, генерируется автоматически по описанию.

Про генерацию раскладки можно прочитать подробнее в [другой моей
статье](https://bouncepaw.github.io/wakizashi-config).

Исходный код вакидзаси можно прочитать в [репозитории
bouncepaw/wakizashi](https://github.com/bouncepaw/wakizashi).

## Раскладка

На аккорды, состоящие всего из одной клавиши, я повесил самые нужные вещи: самые
частые буквы, точка, запятая, пробел. Дальше, чем сложнее аккорд, тем реже он
нужен. В целом, буквы расположены по частоте употребления, цифры расположены как
будто бинарно их пишешь, символы где попало, функциональные клавиши я не
закончил распологать.

На момент написания статьи вакидзаси готова, я на ней могу писать. Проедусь по
фундаментальным косякам.

## Фундаментальные косяки

1. Сложно нажимать на самый дальний тамб (следствие из ортолинейности клавиатуры
   и размеров сетки, куда ставил свичи). Из-за этого:

   1. Сложно писать макросы. Настолько, что гораздо проще написать слово по
      кусочкам.
   2. Функциональные клавиши тоже неудобно писать.

   Чтобы решить те две проблемы, надо просто и макросы, и функциональные клавиши
   разместить в основной части раскладке, которая без тамбов всяких. Количество
   доступных аккордов позволяет.
2. Мало кнопок. Это не косяк, а так задумано, но из-за этого есть прямо косяки:
   1. Нет места для привычных модификаторов (меня интересуют пять: левые
      `Shift`, `Ctrl`, `Alt`, `Super|⌘|Win` и правый `Alt`). Для первых четырёх
      модификаторов предусмотрены аккорды, включающие соответствующие режимы,
      которые отправляют модификаторы, пока его не выключишь (аккордом,
      естественно).

      Также `Shift` естественным образом включён в обычные аккорды (например те,
      которые большие буквы), правый `Alt` по идее тоже должен быть, но пока до
      этой части не добрался.

      `Ctrl` ещё легко отправляется, но что касается `Alt` и `Super|⌘|Win`, для
      них надо включать этот дурацкий режим, а потом ещё отключать. Таким
      образом, быстрый хоткей `⌘C` (копировать) превращается в следующее:

      1. Аккорд `0001 0000 001`.
      2. Аккорд `0110 0000 000`.
      3. Аккорд `1111 0000 000`.

      Это уже не так быстро, да и нагрузка на мозг гораздо больше. Пропадает вся
      суть хоткея, который должен ускорять работу.
   2. Много аккордов с большим количеством кнопок. Если бы я добавил сверху ещё
      ряд клавиш, то простых аккордов было бы в разы больше.

Несмотря на это (а это *это* нельзя не смотреть), вакидзаси несомненно хороша:

## Преимущества

1. Всё рядом. Раньше я ругал верхнюю кнопку для мизинца, но потом выяснилось,
   что с ней всё в порядке. Ещё я ругал правый тамб. Пускай он далеко, но
   фактически он всё ещё «под пальцем», для него не надо двигать руку.
2. Легко подключается к компьютеру. Мой макбук сразу признал в вакидзаси
   клавиатуру, всё работает хорошо. Линукс тоже хорошо понимает. Увы, на винде
   нет ничего святого, при подключении ОС начинает искать драйвера, хотя какие
   драйвера нужны для стандартного клавиатурного протокола?
3. Я использовал самые лёгкие свичи на рынке (Gateron Clear), поэтому легко
   нажимать на любое количество кнопок за раз.
4. Легко изменять раскладку. Надо отредактировать CSV-файлы, а потом запустить
   весь процесс одной командой в консоли: `make`.
5. Аккорды легко учатся.

## Выводы

Клавиатура изначально была экспериментом, проверкой идеи аккордовых клавиатур.
Вот что я понял:

1. Аккордовые клавиатуры круты!

   Я за 20 минут смог научиться писать со скоростью, до какой многие
   пользователи ПК не достигли за много лет (я про тех, которые пишут одним
   пальцем).

   Увы, эта достигнутая скорость очень мала. Сначала я хотел написать эту статью
   именно с вакидзаси, но устал тратить столько времени. Я сомневаюсь, что
   аккордовая клавиатура с моим принципом и с таким малым количеством кнопок
   способна быть такой же быстрой, как любая полная неаккордовая клавиатура.
2. Клавиатуры интересно делать.

   Я буду делать другую. У меня уже есть идеи.
3. Кнопки для модификаторов нужны.

   Хотя, есть люди, которым и без них хорошо. Многие всю свою жизнь проводят в
   редакторе `vim`, где почти всё делается без модификаторов, но я пользуюсь
   редактором *GNU Emacs*, где без модификаторов никак.
4. Вакидзаси хороша для набора текста, но не для работы с компьютером.
